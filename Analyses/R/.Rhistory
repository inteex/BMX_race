}
return("Done")
}
Projection_ACP(c("Valentino_2018-12-14"),"var")
Projection_ACP = function(Labels,choix) {
Data = read.csv('C:/Users/1mduquesnoy/Downloads/BMX_race/Analyses/Données/Frames/Base_Frames.csv',sep=";",header=TRUE)
Data = subset(Data, select=c("DistanceRecul","DAlignementMin","DEpauleMin",
"DistanceDmin","EngagementDmin","HauteurFWRecul","Intention","HauteurFWDmin",
"ForceUPiedAvMax","ForceUPiedArMax","MoyennePuissanceButteTotale","MoyennePuissancePremCassure","PuissanceMaxPremCassure",
"TpsPassageGrille","TpsPremCassure","TpsBasDeButte","VitesseBasDeButte",
"VMaxPremCassure","ImpulsionParCoups","TravailParCoups","ImpulsionParCoups_1","TravailParCoups_1",
"ImpulsionParCoups_2","TravailParCoups_2","ImpulsionParCoups_3","TravailParCoups_3","ImpulsionParCoups_4",
"TravailParCoups_4","Time2Peak","Nom","Prenom","Numero","Date","Manivelle","Theta.Depart","Theta.Recul",
"Braquet","Temps.Reaction","Explosivite"))
N = length(Data[,1])
P = length(Data[1,])
Test = c()
Labels_Init = c("Pilard_2018-06-21","Rencurel_2018-12-12","Ragot_2018-12-11","Mayet_2018-06-19","Mahieu_2018-12-13",
"Racine_2018-06-22","Andre_2018-12-12","Darnand_2018-06-21","Jouve_2018-06-20")
Labels_Sup = c()
Base_Init = c()
for (i in 1:N) {
if ( paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels_Init || paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels) {
Base_Init = rbind(Base_Init,Data[i,])
}
}
for (i in 1:length(Base_Init[,1])) {
if ( paste(as.vector(Base_Init$Nom[i]), as.vector(Base_Init$Date)[i],sep="_") %in% Labels) {
Labels_Sup = c(Labels_Sup,i)
}
}
row_names = c()
for (i in 1:length(Base_Init[,1])) {
row_names[i] = paste(paste(as.vector(Base_Init$Nom)[i],as.vector(Base_Init$Numero)[i],sep="_"),as.vector(Base_Init$Date)[i],sep="_")
}
rownames(Base_Init) = row_names
Base_Init = Base_Init[ , ! colnames(Base_Init) %in% c("Nom","Prenom","Date","Numero")]
res = PCA(Base_Init, scale.unit=TRUE, ncp=5, ind.sup=Labels_Sup, graph = FALSE)
fviz_pca_var(res)
# if (choix == "ind") {
#   fviz_pca_ind(res, axes = c(1, 2), geom = c("point", "text"),
#                label = "all", invisible = "none", labelsize = 4,
#                pointsize = 2, habillage = "none",
#                col.ind = "#024efd", col.ind.sup = "#fb040b"
#                )
# }
#
# else if (choix == "var") {
#   fviz_pca_var(res)
#   print("non")
# }
return("Done")
}
Projection_ACP(c("Valentino_2018-12-14"),"var")
Projection_ACP = function(Labels,choix) {
Data = read.csv('C:/Users/1mduquesnoy/Downloads/BMX_race/Analyses/Données/Frames/Base_Frames.csv',sep=";",header=TRUE)
Data = subset(Data, select=c("DistanceRecul","DAlignementMin","DEpauleMin",
"DistanceDmin","EngagementDmin","HauteurFWRecul","Intention","HauteurFWDmin",
"ForceUPiedAvMax","ForceUPiedArMax","MoyennePuissanceButteTotale","MoyennePuissancePremCassure","PuissanceMaxPremCassure",
"TpsPassageGrille","TpsPremCassure","TpsBasDeButte","VitesseBasDeButte",
"VMaxPremCassure","ImpulsionParCoups","TravailParCoups","ImpulsionParCoups_1","TravailParCoups_1",
"ImpulsionParCoups_2","TravailParCoups_2","ImpulsionParCoups_3","TravailParCoups_3","ImpulsionParCoups_4",
"TravailParCoups_4","Time2Peak","Nom","Prenom","Numero","Date","Manivelle","Theta.Depart","Theta.Recul",
"Braquet","Temps.Reaction","Explosivite"))
N = length(Data[,1])
P = length(Data[1,])
Test = c()
Labels_Init = c("Pilard_2018-06-21","Rencurel_2018-12-12","Ragot_2018-12-11","Mayet_2018-06-19","Mahieu_2018-12-13",
"Racine_2018-06-22","Andre_2018-12-12","Darnand_2018-06-21","Jouve_2018-06-20")
Labels_Sup = c()
Base_Init = c()
for (i in 1:N) {
if ( paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels_Init || paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels) {
Base_Init = rbind(Base_Init,Data[i,])
}
}
for (i in 1:length(Base_Init[,1])) {
if ( paste(as.vector(Base_Init$Nom[i]), as.vector(Base_Init$Date)[i],sep="_") %in% Labels) {
Labels_Sup = c(Labels_Sup,i)
}
}
row_names = c()
for (i in 1:length(Base_Init[,1])) {
row_names[i] = paste(paste(as.vector(Base_Init$Nom)[i],as.vector(Base_Init$Numero)[i],sep="_"),as.vector(Base_Init$Date)[i],sep="_")
}
rownames(Base_Init) = row_names
Base_Init = Base_Init[ , ! colnames(Base_Init) %in% c("Nom","Prenom","Date","Numero")]
res = PCA(Base_Init, scale.unit=TRUE, ncp=5, ind.sup=Labels_Sup, graph = FALSE)
plot.PCA(res, axes=c(1, 2), choix="ind", habillage="none",
col.ind="#024efd", col.ind.sup="#fb040b", col.quali="magenta",
label=c("ind", "ind.sup", "quali"),new.plot=TRUE, title="")
#fviz_pca_var(res)
# if (choix == "ind") {
#   fviz_pca_ind(res, axes = c(1, 2), geom = c("point", "text"),
#                label = "all", invisible = "none", labelsize = 4,
#                pointsize = 2, habillage = "none",
#                col.ind = "#024efd", col.ind.sup = "#fb040b"
#                )
# }
#
# else if (choix == "var") {
#   fviz_pca_var(res)
#   print("non")
# }
return("Done")
}
Projection_ACP(c("Valentino_2018-12-14"),"var")
Projection_ACP = function(Labels,choix) {
Data = read.csv('C:/Users/1mduquesnoy/Downloads/BMX_race/Analyses/Données/Frames/Base_Frames.csv',sep=";",header=TRUE)
Data = subset(Data, select=c("DistanceRecul","DAlignementMin","DEpauleMin",
"DistanceDmin","EngagementDmin","HauteurFWRecul","Intention","HauteurFWDmin",
"ForceUPiedAvMax","ForceUPiedArMax","MoyennePuissanceButteTotale","MoyennePuissancePremCassure","PuissanceMaxPremCassure",
"TpsPassageGrille","TpsPremCassure","TpsBasDeButte","VitesseBasDeButte",
"VMaxPremCassure","ImpulsionParCoups","TravailParCoups","ImpulsionParCoups_1","TravailParCoups_1",
"ImpulsionParCoups_2","TravailParCoups_2","ImpulsionParCoups_3","TravailParCoups_3","ImpulsionParCoups_4",
"TravailParCoups_4","Time2Peak","Nom","Prenom","Numero","Date","Manivelle","Theta.Depart","Theta.Recul",
"Braquet","Temps.Reaction","Explosivite"))
N = length(Data[,1])
P = length(Data[1,])
Test = c()
Labels_Init = c("Pilard_2018-06-21","Rencurel_2018-12-12","Ragot_2018-12-11","Mayet_2018-06-19","Mahieu_2018-12-13",
"Racine_2018-06-22","Andre_2018-12-12","Darnand_2018-06-21","Jouve_2018-06-20")
Labels_Sup = c()
Base_Init = c()
for (i in 1:N) {
if ( paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels_Init || paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels) {
Base_Init = rbind(Base_Init,Data[i,])
}
}
for (i in 1:length(Base_Init[,1])) {
if ( paste(as.vector(Base_Init$Nom[i]), as.vector(Base_Init$Date)[i],sep="_") %in% Labels) {
Labels_Sup = c(Labels_Sup,i)
}
}
row_names = c()
for (i in 1:length(Base_Init[,1])) {
row_names[i] = paste(paste(as.vector(Base_Init$Nom)[i],as.vector(Base_Init$Numero)[i],sep="_"),as.vector(Base_Init$Date)[i],sep="_")
}
rownames(Base_Init) = row_names
Base_Init = Base_Init[ , ! colnames(Base_Init) %in% c("Nom","Prenom","Date","Numero")]
res = PCA(Base_Init, scale.unit=TRUE, ncp=5, ind.sup=Labels_Sup, graph = FALSE)
plot(fviz_pca_var(res))
# if (choix == "ind") {
#   fviz_pca_ind(res, axes = c(1, 2), geom = c("point", "text"),
#                label = "all", invisible = "none", labelsize = 4,
#                pointsize = 2, habillage = "none",
#                col.ind = "#024efd", col.ind.sup = "#fb040b"
#                )
# }
#
# else if (choix == "var") {
#   fviz_pca_var(res)
#   print("non")
# }
return("Done")
}
Projection_ACP(c("Valentino_2018-12-14"),"var")
Projection_ACP = function(Labels,choix) {
Data = read.csv('C:/Users/1mduquesnoy/Downloads/BMX_race/Analyses/Données/Frames/Base_Frames.csv',sep=";",header=TRUE)
Data = subset(Data, select=c("DistanceRecul","DAlignementMin","DEpauleMin",
"DistanceDmin","EngagementDmin","HauteurFWRecul","Intention","HauteurFWDmin",
"ForceUPiedAvMax","ForceUPiedArMax","MoyennePuissanceButteTotale","MoyennePuissancePremCassure","PuissanceMaxPremCassure",
"TpsPassageGrille","TpsPremCassure","TpsBasDeButte","VitesseBasDeButte",
"VMaxPremCassure","ImpulsionParCoups","TravailParCoups","ImpulsionParCoups_1","TravailParCoups_1",
"ImpulsionParCoups_2","TravailParCoups_2","ImpulsionParCoups_3","TravailParCoups_3","ImpulsionParCoups_4",
"TravailParCoups_4","Time2Peak","Nom","Prenom","Numero","Date","Manivelle","Theta.Depart","Theta.Recul",
"Braquet","Temps.Reaction","Explosivite"))
N = length(Data[,1])
P = length(Data[1,])
Test = c()
Labels_Init = c("Pilard_2018-06-21","Rencurel_2018-12-12","Ragot_2018-12-11","Mayet_2018-06-19","Mahieu_2018-12-13",
"Racine_2018-06-22","Andre_2018-12-12","Darnand_2018-06-21","Jouve_2018-06-20")
Labels_Sup = c()
Base_Init = c()
for (i in 1:N) {
if ( paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels_Init || paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels) {
Base_Init = rbind(Base_Init,Data[i,])
}
}
for (i in 1:length(Base_Init[,1])) {
if ( paste(as.vector(Base_Init$Nom[i]), as.vector(Base_Init$Date)[i],sep="_") %in% Labels) {
Labels_Sup = c(Labels_Sup,i)
}
}
row_names = c()
for (i in 1:length(Base_Init[,1])) {
row_names[i] = paste(paste(as.vector(Base_Init$Nom)[i],as.vector(Base_Init$Numero)[i],sep="_"),as.vector(Base_Init$Date)[i],sep="_")
}
rownames(Base_Init) = row_names
Base_Init = Base_Init[ , ! colnames(Base_Init) %in% c("Nom","Prenom","Date","Numero")]
res = PCA(Base_Init, scale.unit=TRUE, ncp=5, ind.sup=Labels_Sup, graph = FALSE)
if (choix == "ind") {
plot(fviz_pca_ind(res, axes = c(1, 2), geom = c("point", "text"),
label = "all", invisible = "none", labelsize = 4,
pointsize = 2, habillage = "none",
col.ind = "#024efd", col.ind.sup = "#fb040b"
))
}
else if (choix == "var") {
plot(fviz_pca_var(res, axes = c(1, 2), geom = c("arrow", "text"),
label = "all", invisible = "none", labelsize = 4,
col.var = "#012efe", col.quanti.sup = "blue"
))
}
return("Done")
}
Projection_ACP(c("Valentino_2018-12-14"),"var")
Projection_ACP(c("Valentino_2018-12-14"),"ind")
Projection_ACP(c("Valentino_2018-12-14"),"ind")
Projection_ACP = function(Labels,choix) {
Data = read.csv('C:/Users/1mduquesnoy/Downloads/BMX_race/Analyses/Données/Frames/Base_Frames.csv',sep=";",header=TRUE)
Data = subset(Data, select=c("DistanceRecul","DAlignementMin","DEpauleMin",
"DistanceDmin","EngagementDmin","HauteurFWRecul","Intention","HauteurFWDmin",
"ForceUPiedAvMax","ForceUPiedArMax","MoyennePuissanceButteTotale","MoyennePuissancePremCassure","PuissanceMaxPremCassure",
"TpsPassageGrille","TpsPremCassure","TpsBasDeButte","VitesseBasDeButte",
"VMaxPremCassure","ImpulsionParCoups","TravailParCoups","ImpulsionParCoups_1","TravailParCoups_1",
"ImpulsionParCoups_2","TravailParCoups_2","ImpulsionParCoups_3","TravailParCoups_3","ImpulsionParCoups_4",
"TravailParCoups_4","Time2Peak","Nom","Prenom","Numero","Date","Manivelle","Theta.Depart","Theta.Recul",
"Braquet","Temps.Reaction","Explosivite"))
N = length(Data[,1])
P = length(Data[1,])
Test = c()
Labels_Init = c("Pilard_2018-06-21","Rencurel_2018-12-12","Ragot_2018-12-11","Mayet_2018-06-19","Mahieu_2018-12-13",
"Racine_2018-06-22","Andre_2018-12-12","Darnand_2018-06-21","Jouve_2018-06-20")
Labels_Sup = c()
Base_Init = c()
for (i in 1:N) {
if ( paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels_Init || paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels) {
Base_Init = rbind(Base_Init,Data[i,])
}
}
for (i in 1:length(Base_Init[,1])) {
if ( paste(as.vector(Base_Init$Nom[i]), as.vector(Base_Init$Date)[i],sep="_") %in% Labels) {
Labels_Sup = c(Labels_Sup,i)
}
}
row_names = c()
for (i in 1:length(Base_Init[,1])) {
row_names[i] = paste(paste(as.vector(Base_Init$Nom)[i],as.vector(Base_Init$Numero)[i],sep="_"),as.vector(Base_Init$Date)[i],sep="_")
}
rownames(Base_Init) = row_names
Base_Init = Base_Init[ , ! colnames(Base_Init) %in% c("Nom","Prenom","Date","Numero")]
res = PCA(Base_Init, scale.unit=TRUE, ncp=5, ind.sup=Labels_Sup, graph = FALSE)
if (choix == "ind") {
plot(fviz_pca_ind(res, axes = c(1, 2), geom = c("point", "text"),
label = "all", invisible = "none", labelsize = 4,
pointsize = 2, habillage = "none",
col.ind = "#024efd", col.ind.sup = "#fb040b",
title = "Visualisation des pilotes supplémentaires sur la projection des individus"
))
}
else if (choix == "var") {
plot(fviz_pca_var(res, axes = c(1, 2), geom = c("arrow", "text"),
label = "all", invisible = "none", labelsize = 4,
col.var = "#012efe", col.quanti.sup = "blue",
title = "Projection des variables sur le plan princpal 1-2"))
}
return("Done")
}
Projection_ACP(c("Valentino_2018-12-14"),"ind")
Projection_ACP = function(Labels,choix) {
Data = read.csv('C:/Users/1mduquesnoy/Downloads/BMX_race/Analyses/Données/Frames/Base_Frames.csv',sep=";",header=TRUE)
Data = subset(Data, select=c("DistanceRecul","DAlignementMin","DEpauleMin",
"DistanceDmin","EngagementDmin","HauteurFWRecul","Intention","HauteurFWDmin",
"ForceUPiedAvMax","ForceUPiedArMax","MoyennePuissanceButteTotale","MoyennePuissancePremCassure","PuissanceMaxPremCassure",
"TpsPassageGrille","TpsPremCassure","TpsBasDeButte","VitesseBasDeButte",
"VMaxPremCassure","ImpulsionParCoups","TravailParCoups","ImpulsionParCoups_1","TravailParCoups_1",
"ImpulsionParCoups_2","TravailParCoups_2","ImpulsionParCoups_3","TravailParCoups_3","ImpulsionParCoups_4",
"TravailParCoups_4","Time2Peak","Nom","Prenom","Numero","Date","Manivelle","Theta.Depart","Theta.Recul",
"Braquet","Temps.Reaction","Explosivite"))
N = length(Data[,1])
P = length(Data[1,])
Test = c()
Labels_Init = c("Pilard_2018-06-21","Rencurel_2018-12-12","Ragot_2018-12-11","Mayet_2018-06-19","Mahieu_2018-12-13",
"Racine_2018-06-22","Andre_2018-12-12","Darnand_2018-06-21","Jouve_2018-06-20")
Labels_Sup = c()
Base_Init = c()
for (i in 1:N) {
if ( paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels_Init || paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels) {
Base_Init = rbind(Base_Init,Data[i,])
}
}
for (i in 1:length(Base_Init[,1])) {
if ( paste(as.vector(Base_Init$Nom[i]), as.vector(Base_Init$Date)[i],sep="_") %in% Labels) {
Labels_Sup = c(Labels_Sup,i)
}
}
row_names = c()
for (i in 1:length(Base_Init[,1])) {
row_names[i] = paste(paste(as.vector(Base_Init$Nom)[i],as.vector(Base_Init$Numero)[i],sep="_"),as.vector(Base_Init$Date)[i],sep="_")
}
rownames(Base_Init) = row_names
Base_Init = Base_Init[ , ! colnames(Base_Init) %in% c("Nom","Prenom","Date","Numero")]
res = PCA(Base_Init, scale.unit=TRUE, ncp=5, ind.sup=Labels_Sup, graph = FALSE)
if (choix == "ind") {
plot(fviz_pca_ind(res, axes = c(1, 2), geom = c("point", "text"),
label = "all", invisible = "none", labelsize = 4,
pointsize = 2, habillage = "none",
col.ind = "#024efd", col.ind.sup = "#fb040b",
title = "Visualisation des pilotes supplémentaires sur la projection des individus"
))
}
else if (choix == "var") {
plot(fviz_pca_var(res, axes = c(1, 2), geom = c("arrow", "text"),
label = "all", invisible = "none", labelsize = 4,
col.var = "#012efe", col.quanti.sup = "blue",
title = "Projection des variables sur le plan princpal 1-2",
select.var = list(name =NULL, cos2 = NULL, contrib = 25)))
}
return("Done")
}
Projection_ACP(c("Valentino_2018-12-14"),"ind")
Projection_ACP(c("Valentino_2018-12-14"),"var")
Projection_ACP = function(Labels,choix) {
Data = read.csv('C:/Users/1mduquesnoy/Downloads/BMX_race/Analyses/Données/Frames/Base_Frames.csv',sep=";",header=TRUE)
Data = subset(Data, select=c("DistanceRecul","DAlignementMin","DEpauleMin",
"DistanceDmin","EngagementDmin","HauteurFWRecul","Intention","HauteurFWDmin",
"ForceUPiedAvMax","ForceUPiedArMax","MoyennePuissanceButteTotale","MoyennePuissancePremCassure","PuissanceMaxPremCassure",
"TpsPassageGrille","TpsPremCassure","TpsBasDeButte","VitesseBasDeButte",
"VMaxPremCassure","ImpulsionParCoups","TravailParCoups","ImpulsionParCoups_1","TravailParCoups_1",
"ImpulsionParCoups_2","TravailParCoups_2","ImpulsionParCoups_3","TravailParCoups_3","ImpulsionParCoups_4",
"TravailParCoups_4","Time2Peak","Nom","Prenom","Numero","Date","Manivelle","Theta.Depart","Theta.Recul",
"Braquet","Temps.Reaction","Explosivite"))
N = length(Data[,1])
P = length(Data[1,])
Test = c()
Labels_Init = c("Pilard_2018-06-21","Rencurel_2018-12-12","Ragot_2018-12-11","Mayet_2018-06-19","Mahieu_2018-12-13",
"Racine_2018-06-22","Andre_2018-12-12","Darnand_2018-06-21","Jouve_2018-06-20")
Labels_Sup = c()
Base_Init = c()
for (i in 1:N) {
if ( paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels_Init || paste(as.vector(Data$Nom[i]), as.vector(Data$Date)[i],sep="_") %in% Labels) {
Base_Init = rbind(Base_Init,Data[i,])
}
}
for (i in 1:length(Base_Init[,1])) {
if ( paste(as.vector(Base_Init$Nom[i]), as.vector(Base_Init$Date)[i],sep="_") %in% Labels) {
Labels_Sup = c(Labels_Sup,i)
}
}
row_names = c()
for (i in 1:length(Base_Init[,1])) {
row_names[i] = paste(paste(as.vector(Base_Init$Nom)[i],as.vector(Base_Init$Numero)[i],sep="_"),as.vector(Base_Init$Date)[i],sep="_")
}
rownames(Base_Init) = row_names
Base_Init = Base_Init[ , ! colnames(Base_Init) %in% c("Nom","Prenom","Date","Numero")]
res = PCA(Base_Init, scale.unit=TRUE, ncp=5, ind.sup=Labels_Sup, graph = FALSE)
if (choix == "ind") {
plot(fviz_pca_ind(res, axes = c(1, 2), geom = c("point", "text"),
label = "all", invisible = "none", labelsize = 4,
pointsize = 2, habillage = "none",
col.ind = "#024efd", col.ind.sup = "#fb040b",
title = "Visualisation des pilotes supplémentaires sur la projection des individus",
jitter = list(what = "label", width = NULL, height = NULL)))
}
else if (choix == "var") {
plot(fviz_pca_var(res, axes = c(1, 2), geom = c("arrow", "text"),
label = "all", invisible = "none", labelsize = 4,
col.var = "#012efe", col.quanti.sup = "blue",
title = "Projection des variables sur le plan princpal 1-2",
select.var = list(name =NULL, cos2 = NULL, contrib = 25),
jitter = list(what = "label", width = NULL, height = NULL)))
}
return("Done")
}
Projection_ACP(c("Valentino_2018-12-14"),"var")
Projection_ACP(c("Valentino_2018-12-14"),"ind")
N
N[1[c(1:5)]]
N[1]
N[1][c(1,2)]
N[1]
unlist(N[1])
unlist(N[1])[1:2]
unlist(N[1])[1:4]
as.vector(N[1])
as.vector(N[1])[1:2]
N3 = Data$Date
N3[1]
as.vector(N3[1])
str_detect(as.vector(N3[1]),"-")
str_split(as.vector(N3[1]),"-")
t=str_split(as.vector(N3[1]),"-")
t[2]
unlist(t)[2]
library(funHDDC)
library(funData)
library(fda)
library(fda.usc)
library(stringr)
library(Rcmdr)
library(factoextra)
library(FactoMineR)
setwd(dir = "C:/Users/1mduquesnoy/Downloads/BMX_race/Analyses/R")
Creation_Test_Puissance = function(Name) {
#Creation of the input XTest
#Thus the output is a dataset with all the new powers to be predict.
#param Name   : the name (as a string) of the file containing all the new trials
X = read.csv(paste('Nouveaute/',Name,sep=""))
ID = X[,1]
Power_Test = X[,-1]
return(list("X_Test"=Power_Test,"ID"=ID))
}
Creation_Test = function(Name) {
##Creation of the input XTest
#Thus the output is a dataset with all the new feature to be predict.
#param Name   : the name (as a string) of the file containing all the new trials
X = read.csv(paste('Nouveaute/',Name,sep=""))
ID = X[,1]
Power_Test = X[,-1]
return(list("X_Test"=Power_Test,"ID"=ID))
}
Classification_Puissance = function(X_Test) {
#For new trials, it predict the power's class
#param : a P*N dataset containing all the new curves of power
XTrain = read.csv("Module/XTrain_Puissance.csv",sep=";")
YTrain = unlist(read.csv("Module/YTrain_Puissance.csv",sep=";"))
dataf<-data.frame(as.factor(YTrain))
x=fdata(XTrain)
dat=list("df"=dataf,"x"=x)
mod=classif.knn(as.factor(YTrain),x,knn=i)
xx=fdata(X_Test)
newdat<-list("x"=xx)
p1<-predict.classif(mod,xx)
return(p1)
}
Exportation = function(ID,Values,Name) {
#Export in a csv, all the reuslts came down to your new trials
#param ID      : a list with the informations about the identity of the trial
#param Values  : a list with all the values from the model
#param Name    : a string with the name of the file
X = cbind(as.vector(ID),as.vector(Values))
write.table(X, paste(paste("../Sorties_Modeles/",Name,sep=""),".csv",sep=""),
row.names=FALSE, sep=";",dec=".", na=" ")
}
Clustering = function(X,k) {
#Univariate clustering with functional data, find all the modeles as possible
#param X : dataset J*Q where Q is the number of curve and J the length
#param k : the number of clusters
N=length(X[,1])
P=length(X[1,])
basis<- create.bspline.basis(c(0,1), nbasis=25)
var1<-smooth.basis(argvals=seq(0,1,length.out = P),y=t(X),fdParobj=basis)$fd
res.uni<-funHDDC(var1,K=1:k,model=c('AkBkQkDk','ABkQkDk', 'AkBQkDk', 'ABQkDk'),init="kmeans",threshold=0.2)
#print(res.uni)
}
Clustering_Best = function(X,model,k) {
#Make a model with the best parameters found previously
#param X     : dataset J*Q where Q is the number of curve and J the length
#param k     : the number of clusters
#param model : string with the name of the model
N=length(X[,1])
P=length(X[1,])
basis<- create.bspline.basis(c(0,1), nbasis=25)
var1<-smooth.basis(argvals=seq(0,1,length.out = P),y=t(X),fdParobj=basis)$fd
res.uni<-funHDDC(var1,K=k,model=model,init="kmeans",threshold=0.2)
return(list(mod=res.uni,class=res.uni$class))
}
X = Creation_Test("Test_Clustering")
X = Creation_Test("Test_Clustering.csv")
#X$X_Test[is.na(X$X_Test)] <- median(unlist(X$X_Test[4,]))
Clustering(X$X_Test,4)
Clustering = function(X,k) {
#Univariate clustering with functional data, find all the modeles as possible
#param X : dataset J*Q where Q is the number of curve and J the length
#param k : the number of clusters
N=length(X[,1])
P=length(X[1,])
basis<- create.bspline.basis(c(0,1), nbasis=25)
var1<-smooth.basis(argvals=seq(0,1,length.out = P),y=t(X),fdParobj=basis)$fd
res.uni<-funHDDC(var1,K=1:k,model=c('AkBkQkDk','ABkQkDk', 'AkBQkDk', 'ABQkDk'),init="kmeans",threshold=0.2)
plot(res.uni)
}
#X$X_Test[is.na(X$X_Test)] <- median(unlist(X$X_Test[4,]))
Clustering(X$X_Test,4)
Clustering = function(X,k) {
#Univariate clustering with functional data, find all the modeles as possible
#param X : dataset J*Q where Q is the number of curve and J the length
#param k : the number of clusters
N=length(X[,1])
P=length(X[1,])
basis<- create.bspline.basis(c(0,1), nbasis=25)
var1<-smooth.basis(argvals=seq(0,1,length.out = P),y=t(X),fdParobj=basis)$fd
res.uni<-funHDDC(var1,K=1:k,model=c('AkBkQkDk','ABkQkDk', 'AkBQkDk', 'ABQkDk'),init="kmeans",threshold=0.2)
print(res.uni)
}
#X$X_Test[is.na(X$X_Test)] <- median(unlist(X$X_Test[4,]))
Clustering(X$X_Test,4)
Clustering = function(X,k) {
#Univariate clustering with functional data, find all the modeles as possible
#param X : dataset J*Q where Q is the number of curve and J the length
#param k : the number of clusters
N=length(X[,1])
P=length(X[1,])
basis<- create.bspline.basis(c(0,1), nbasis=25)
var1<-smooth.basis(argvals=seq(0,1,length.out = P),y=t(X),fdParobj=basis)$fd
res.uni<-funHDDC(var1,K=1:k,model=c('AkBkQkDk','ABkQkDk', 'AkBQkDk', 'ABQkDk'),init="kmeans",threshold=0.2)
print(res.uni$BIC)
}
#X$X_Test[is.na(X$X_Test)] <- median(unlist(X$X_Test[4,]))
Clustering(X$X_Test,4)
daybasis65 <- create.fourier.basis(c(0, 365), nbasis=65, period=365)
daytempfd <- smooth.basis(day.5, CanadianWeather$dailyAv[,,"Temperature.C"], daybasis65,
fdnames=list("Day", "Station", "Deg C"))$fd
res.uni<-funHDDC(daytempfd,K=3,model="AkjBkQkDk",init="random",threshold=0.2)
daybasis65 <- create.fourier.basis(c(0, 365), nbasis=65, period=365)
daytempfd <- smooth.basis(day.5, CanadianWeather$dailyAv[,,"Temperature.C"], daybasis65,
fdnames=list("Day", "Station", "Deg C"))$fd
res.uni<-funHDDC(daytempfd,K=3,model="AkjBkQkDk",init="random",threshold=0.2)
res.uni<-funHDDC(daytempfd,K=1:5,model="AkjBkQkDk",init="random",threshold=0.2)
res.uni<-funHDDC(daytempfd,K=1:5,init="random",threshold=0.2)
dim(Puissance)
